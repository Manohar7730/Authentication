<link rel="stylesheet" href="/css/home.css">
<header>
    <p>Home</p>
</header>

<section id="feed-posts">
    <h4>Posts</h4>
    <% if(locals.user) { %>
        <form action="/post/create" method="post" id="new-post-form">
            <textarea name="content" cols="30" rows="3" placeholder="Type here..."></textarea>
            <input type="submit" value="Post">
        </form>
        <% } %>
            <div id="post-list-container">
                <ul>
                    <% for(post of posts) { %>
                        <li class="post-item">
                            <p class="post-item-content">
                                <% if(locals.user && locals.user.id==post.user.id ){%>
                                    <small><a href="/post/delete/<%= post.id %>">X</a></small>
                                    <%}%>
                                        <%= post.content %>
                                            <br>
                                            <small id="post-user-name">
                                                <%= post.user.name %>
                                            </small>
                            </p>
                            <div class="post-comments">
                                <% if(locals.user) { %>
                                    <form action="/comment/create" method="post">
                                        <input type="text" name="content" placeholder="Type here to add a comment...">
                                        <input type="hidden" name="post" value="<%= post._id %>">
                                        <input type="submit" value="Add Comment">
                                    </form>
                                    <% } %>
                                        <div class="post-comments-list">
                                            <ul id="post-comment-<%= post._id %>">
                                                <% for(comment of post.comments) { %>
                                                    <li class="comment-item">
                                                        <p class="comment-item-content">
                                                            <%= comment.content %>
                                                        </p>
                                                        <small id="comment-user-name">
                                                            <%= comment.user.name %>
                                                        </small>
                                                    </li>
                                                    <% } %>
                                            </ul>
                                        </div>
                            </div>
                        </li>
                        <% } %>
                </ul>
            </div>
</section>